{"version":3,"file":"sdk_stockthumbs.js","names":["stockThumbsConfig","stockThumbsMain","jqLoaded","window","StockThumbs","init","config","custom","addEventListener","e","loadScripts","target","removeEventListener","once","passive","stm","Object","assign","getFilters","setFilters","AdobeStock","stc","utils","includePath","PATH","getTrackingUrl","url","cfg","camRef","encodeURIComponent","pubRef","getHost","host","document","location","hostname","base","querySelector","href","tmpLink","createElement","stockHomeUrl","getCtaText","fmfUrl","videoUrl","cta","fmf","video","ctaLink","sbHeader","parseFilters","filters","searchFilters","$jq","filterMap","entries","stkParams","SEARCH_PARAMS","forEach","key","currentValue","value","prototype","hasOwnProperty","call","undefined","firstImg","getSrcSet","srcset","split","attr","$el","isInput","is","phrase","val","text","keywords","keywordx","extract","language","remove_digits","return_changed_case","remove_duplicates","keywordCount","searchWords","length","slice","join","sizes","targetSize","indexOf","reduce","a","b","newSize","Math","abs","$getContDiv","el","mainClass","dataId","$tempDiv","$dataDiv","find","hasClass","$mainDiv","addClass","append","Error","updateUiThumbs","files","wrapClass","bodyClass","itemClass","tipClass","iconClass","columns","RESULT_COLUMNS","$sb","parentId","$wrapDiv","$thumbsDiv","width","videoSvg","asset","DETAILS_URL","div","className","link","thumb","videoHandler","type","muted","play","pause","videoSupport","MEDIA_TYPE_ID","source","preload","poster","THUMBNAIL_URL","loop","setAttribute","src","VIDEO_SMALL_PREVIEW_URL","VIDEO_SMALL_PREVIEW_CONTENT_TYPE","appendChild","iconDiv","svg","createRange","createContextualFragment","tag","THUMBNAIL_HTML_TAG","tooltips","tip","tipText","title","textContent","removeAttribute","$tip","$link","showTip","stopPropagation","preventDefault","$img","currentTarget","$off1","offset","$off2","newPos","top","height","left","css","show","hideTip","hide","hover","insertBefore","lastChild","masonry","itemSelector","imagesLoaded","progress","done","setTimeout","visibility","opacity","doSearch","params","defaultParams","limit","searchParams","queryParams","locale","search_parameters","resultColumns","hasCustomColumns","Boolean","result_columns","imageColumns","NB_RESULTS","videoColumns","TITLE","concat","tempFields","stkResults","field","push","stock","apiKey","appName","ENVIRONMENT","PROD","iterator","searchFiles","next","then","response","getResponse","nb_results","catch","err","result","callback","apply","exec","$stockThumbs","$header","error","filename","stack","stacktrace","sourceUrl","current","loc","matcher","name","matchedLoc","lastIndexOf","ex","replace","notify","eventName","event","Event","dispatchEvent","SS","jQuery","noConflict","reqs","imagesloaded","adobestocklib","include","exclude","multiLoad","info","Promise","resolve","reject","scriptTag","async","onload","onerror","body","scriptArr","values","map","script","promiseData","all","Masonry","domReadyHandler","c","attachEvent","cmpVersions","i","diff","regExStrip0","segmentsA","segmentsB","l","min","parseInt","isJQCalled","checkJQ","timerId","jquery","jQ","onreadystatechange","clearTimeout"],"sources":["../src/sdk_stockthumbs.js"],"sourcesContent":["/* eslint-disable no-console */\r\n(() => {\r\n  let stockThumbsConfig = {};\r\n  let stockThumbsMain = null;\r\n  let jqLoaded;\r\n  // expose global object\r\n  window.StockThumbs = {\r\n    init: (config) => {\r\n      stockThumbsConfig = config;\r\n      // rules for app to use alternate options\r\n      stockThumbsConfig.custom = config.custom;\r\n      window.addEventListener('jQueryLoaded', (e) => {\r\n        // prevents a double event\r\n        const loadScripts = jqLoaded(stockThumbsConfig);\r\n        e.target.removeEventListener('jQueryLoaded', loadScripts, false);\r\n      }, { once: true, passive: true });\r\n      window.addEventListener('StockThumbsReady', () => {\r\n        console.log('StockThumbs ready');\r\n        const stm = stockThumbsMain();\r\n        const { StockThumbs } = window;\r\n        // merge custom config rules with global config\r\n        if (StockThumbs.config && StockThumbs.config.custom) {\r\n          stockThumbsConfig.custom = Object.assign(config.custom, StockThumbs.config.custom);\r\n          // initialize custom code with config and main object\r\n          if (StockThumbs.config.custom.init) {\r\n            StockThumbs.config.custom.init(stockThumbsConfig, stm);\r\n          }\r\n        }\r\n        // expose to global object\r\n        StockThumbs.getFilters = stm.getFilters;\r\n        StockThumbs.setFilters = stm.setFilters;\r\n        StockThumbs.config = stockThumbsConfig;\r\n        // now call main init method returned below\r\n        stm.init();\r\n        // modern browser method to remove event handler when done\r\n      }, { once: true, passive: true });\r\n    },\r\n  };\r\n  stockThumbsMain = () => {\r\n    const { AdobeStock } = window;\r\n    const stc = stockThumbsConfig;\r\n    // utility functions for getting tracking urls and paths\r\n    const utils = {\r\n      includePath: window.StockThumbs.PATH,\r\n      // adobe.prf.hn/click/camref:(CamRef)/pubref:(PubRef)/destination:(URL)\r\n      getTrackingUrl: (url, cfg) => `//adobe.prf.hn/click/camref:${cfg.camRef}/pubref:${encodeURIComponent(cfg.pubRef)}/destination:${encodeURIComponent(url)}`,\r\n      getHost: () => {\r\n        let host = document.location.hostname;\r\n        // check if a custom hostname is set\r\n        if (stc.custom && stc.custom.hostname) {\r\n          host = stc.custom.hostname;\r\n        } else {\r\n          // if <base href> is set, return that instead of doc location\r\n          const base = document.querySelector('base') && document.querySelector('base').href;\r\n          // create temporary link and extract hostname\r\n          const tmpLink = document.createElement('a');\r\n          tmpLink.href = base;\r\n          host = tmpLink.hostname;\r\n        }\r\n        return host;\r\n      },\r\n      get stockHomeUrl() {\r\n        return this.getTrackingUrl(`https://stock.adobe.com?as_campaign=${encodeURIComponent(this.getHost())}`, stc);\r\n      },\r\n    };\r\n    // returns cta link per ctaLink config variable\r\n    const getCtaText = () => {\r\n      const fmfUrl = utils.getTrackingUrl(`https://stock.adobe.com/promo/firstmonthfree?as_campaign=${utils.getHost()}`, stc);\r\n      const videoUrl = utils.getTrackingUrl(`https://stock.adobe.com/video?as_campaign=${utils.getHost()}`, stc);\r\n      const cta = {\r\n        fmf: `<p>First month free with <a href=\"${fmfUrl}\" class=\"astock-searchbar-link\" target=\"_blank\">Adobe Stock annual plans</a>.</p>`,\r\n        video: `<p>Save money on Adobe Stock videos <a href=\"${videoUrl}\" class=\"astock-searchbar-link\" target=\"_blank\">with a credit pack</a>.</p>`,\r\n      };\r\n      if (stc.ctaLink === 'video') return cta.video;\r\n      return cta.fmf;\r\n    };\r\n    const sbHeader = `<div class=\"astock-searchbar-header\"><a href=\"${utils.stockHomeUrl}\" target=\"_blank\"><img src=\"${utils.includePath}/stock_2020_dark_400.png\"></a>${getCtaText()}</div>`;\r\n\r\n    function parseFilters(filters) {\r\n      const searchFilters = {};\r\n      const { $jq } = window.StockThumbs;\r\n      if (!filters) return searchFilters;\r\n      // iterate over object using method that won't bother eslint!\r\n      const filterMap = Object.entries(filters);\r\n      const stkParams = AdobeStock.SEARCH_PARAMS;\r\n      // lookup Stock keyname and map to search filter name\r\n      filterMap.forEach(([key, currentValue]) => {\r\n        let value = currentValue;\r\n        if (Object.prototype.hasOwnProperty.call(stkParams, key)) {\r\n          if (key === 'SIMILAR_URL') {\r\n            if (value !== '' && value !== undefined) {\r\n              const firstImg = $jq(`${value} img`)[0] || $jq(`${value}`)[0];\r\n              const getSrcSet = (srcset) => ((srcset) ? srcset.split(', ')[0].split(' ')[0] : undefined);\r\n              const url = $jq(firstImg).attr('src') || getSrcSet($jq(firstImg).attr('srcset'));\r\n              if (url !== '' && url !== undefined) {\r\n                searchFilters[stkParams[key]] = url;\r\n              }\r\n            }\r\n          } else if (key === 'WORDS') {\r\n            // value should be array ['DOM element', keyword count]\r\n            if (value && value[0]) {\r\n              const $el = $jq(value[0]);\r\n              const isInput = $el.is('input');\r\n              const phrase = (isInput) ? $el.val() : $el.text();\r\n              // if element has text get keywords\r\n              if (phrase) {\r\n                const keywords = window.StockThumbs.keywordx.extract(phrase, {\r\n                  language: 'english',\r\n                  remove_digits: true,\r\n                  return_changed_case: true,\r\n                  remove_duplicates: true,\r\n                });\r\n                // if count is not supplied default to 1\r\n                const keywordCount = (value[1]) ? value[1] : 1;\r\n                const searchWords = (keywords.length > 0) ? keywords.slice(0, keywordCount).join(' ') : '';\r\n                console.log('keywords: %o\\nsearching on %s', keywords, searchWords);\r\n                searchFilters[stkParams[key]] = searchWords;\r\n              }\r\n            }\r\n          } else if (value !== '' && value !== undefined) {\r\n            // validate size\r\n            if (key === 'THUMBNAIL_SIZE') {\r\n              const sizes = [110, 160, 220, 240, 500, 1000];\r\n              const targetSize = value;\r\n              // check if size is in array of allowed sizes\r\n              if (sizes.indexOf(targetSize) < 0) {\r\n                value = sizes.reduce((a, b) => {\r\n                  const newSize = (Math.abs(a - targetSize) < Math.abs(b - targetSize) ? a : b);\r\n                  return newSize;\r\n                });\r\n                console.warn('Thumbnail size of %s is not valid. Closest size is %s', targetSize, value);\r\n              }\r\n            }\r\n            searchFilters[stkParams[key]] = value;\r\n          }\r\n        }\r\n      });\r\n      return searchFilters;\r\n    }\r\n\r\n    // returns container div from selector and adds main class\r\n    function $getContDiv(el) {\r\n      const mainClass = 'astock-searchbar';\r\n      const dataId = 'searchbar';\r\n      // get reference to jQuery\r\n      const { $jq } = window.StockThumbs;\r\n      // get reference to target div and data node (might be same)\r\n      let $tempDiv = $jq(el);\r\n      const $dataDiv = $tempDiv.find(`[data-id=${dataId}]`);\r\n      // if data node exists, return it\r\n      if ($dataDiv.length > 0) {\r\n        $tempDiv = $dataDiv;\r\n      // does target node exist\r\n      } else if ($tempDiv.length > 0) {\r\n        // does target node contain main class\r\n        if (!$tempDiv.hasClass(mainClass)) {\r\n          // create new div to be container\r\n          const $mainDiv = $jq(document.createElement('div'));\r\n          // add main class\r\n          $mainDiv.addClass(mainClass);\r\n          // add new container under target and return that\r\n          $tempDiv = $mainDiv;\r\n          $jq(el).append($tempDiv);\r\n        }\r\n        // add data node\r\n        $tempDiv.attr('data-id', dataId);\r\n      // neither exists, throw exception\r\n      } else {\r\n        throw (new Error('StockThumbs error: Container does not exist. Set \"parentId\" to a valid selector.'));\r\n      }\r\n      return $tempDiv;\r\n    }\r\n\r\n    // creates thumbs and inserts -- input is json array\r\n    function updateUiThumbs(...files) {\r\n      if (files.length > 0) {\r\n        const wrapClass = 'astock-searchbar-wrap';\r\n        const bodyClass = 'astock-searchbar-body';\r\n        let itemClass = 'astock-searchbar-item';\r\n        const tipClass = 'astock-searchbar-tip';\r\n        const iconClass = 'astock-searchbar-item-icon';\r\n        // get reference to result columns object\r\n        const columns = AdobeStock.RESULT_COLUMNS;\r\n        // get reference to jQuery\r\n        const { $jq } = window.StockThumbs;\r\n        const $sb = $getContDiv(stc.parentId);\r\n        // wrap thumbnails in container to allow scrolling\r\n        const $wrapDiv = $jq(document.createElement('div'));\r\n        $wrapDiv.addClass(wrapClass);\r\n        const $thumbsDiv = $jq(document.createElement('div'));\r\n        $thumbsDiv.addClass(bodyClass);\r\n        // if body width is less than 150px, apply small item size\r\n        if ($sb.width() <= 150) {\r\n          itemClass = `${itemClass} item-small`;\r\n        }\r\n        // svg video icon\r\n        const videoSvg = '<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 19 12\" style=\"enable-background:new 0 0 19 12; width:19px; height:10px; fill:white;\" xml:space=\"preserve\"><g><path d=\"M17.8,0.8L13,3V0.8C13,0.4,12.6,0,12.2,0H0.8C0.4,0,0,0.4,0,0.8v10.4C0,11.6,0.4,12,0.8,12h11.4c0.4,0,0.8-0.4,0.8-0.8V 9l4.8,2.2c0.5,0.4,1.2,0,1.2-0.7v-9C19,0.9,18.3,0.5,17.8,0.8z\"></path></g></svg>';\r\n        // populate with images using html returned in json\r\n        files.forEach((asset) => {\r\n          // get url to details page on Stock and wrap inside affiliate tracking url\r\n          const url = utils.getTrackingUrl(asset[columns.DETAILS_URL], stc);\r\n          // create div wrapper\r\n          const div = document.createElement('div');\r\n          div.className = itemClass;\r\n          // create anchor with link to details\r\n          const link = document.createElement('a');\r\n          link.href = url;\r\n          link.target = '_blank';\r\n          let thumb;\r\n          const videoHandler = (e) => {\r\n            const { target, type } = e;\r\n            if (type === 'mouseover') {\r\n              target.muted = true;\r\n              target.play();\r\n            } else if (type === 'mouseout') {\r\n              target.pause();\r\n            }\r\n          };\r\n          // construct a different thumb element depending on asset type\r\n          if (stc.videoSupport && asset[columns.MEDIA_TYPE_ID] === 4) {\r\n            // create video and source tag\r\n            const video = document.createElement('video');\r\n            const source = document.createElement('source');\r\n            Object.assign(video, {\r\n              preload: 'none',\r\n              poster: asset[columns.THUMBNAIL_URL],\r\n              loop: 'loop',\r\n            });\r\n            // for some reason, cannot assign these properties\r\n            video.setAttribute('muted', 'muted');\r\n            video.addEventListener('mouseover', videoHandler, false);\r\n            video.addEventListener('mouseout', videoHandler, false);\r\n            Object.assign(source, {\r\n              src: asset[columns.VIDEO_SMALL_PREVIEW_URL],\r\n              type: asset[columns.VIDEO_SMALL_PREVIEW_CONTENT_TYPE],\r\n            });\r\n            // add video source and set thumb as video\r\n            video.appendChild(source);\r\n            // add play icon\r\n            const iconDiv = document.createElement('div');\r\n            iconDiv.className = iconClass;\r\n            const svg = document.createRange().createContextualFragment(videoSvg);\r\n            iconDiv.appendChild(svg);\r\n            div.appendChild(iconDiv);\r\n            link.appendChild(video);\r\n            // get html tag\r\n            const tag = asset[columns.THUMBNAIL_HTML_TAG];\r\n            // convert html string into dom element\r\n            thumb = document.createRange().createContextualFragment(tag);\r\n          } else {\r\n            // get html tag\r\n            const tag = asset[columns.THUMBNAIL_HTML_TAG];\r\n            // convert html string into dom element\r\n            thumb = document.createRange().createContextualFragment(tag);\r\n          }\r\n          // if captions are enabled\r\n          if (stc.tooltips) {\r\n            // create tool tip from image title\r\n            const tip = document.createElement('div');\r\n            tip.className = tipClass;\r\n            // get title text from document-fragment\r\n            const tipText = thumb.querySelector('img').title;\r\n            if (tipText !== '' && tipText !== undefined) {\r\n              tip.textContent = tipText;\r\n              thumb.querySelector('img').removeAttribute('title');\r\n              link.appendChild(tip);\r\n              // create hover behavior for tip\r\n              const $tip = $jq(tip);\r\n              const $link = $jq(link);\r\n              const showTip = (el) => {\r\n                el.stopPropagation();\r\n                el.preventDefault();\r\n                const $img = $jq(el.currentTarget);\r\n                const $off1 = $img.offset();\r\n                const $off2 = $sb.offset();\r\n                const newPos = {\r\n                  top: ($off1.top - $off2.top) + $img.height(),\r\n                  left: ($off1.left - $off2.left) + $img.width(),\r\n                };\r\n                $tip.css({\r\n                  top: newPos.top,\r\n                  left: newPos.left,\r\n                });\r\n                // console.log('final pos', newPos);\r\n                $tip.show();\r\n                // change parent to main div\r\n                $sb.append($tip);\r\n              };\r\n              const hideTip = (el) => {\r\n                $tip.css($jq(el.currentTarget).offset());\r\n                $tip.hide();\r\n                // reset parent to link\r\n                $link.append($tip);\r\n              };\r\n              // $jq(thumb.querySelector('img')).hover(showTip);\r\n              $jq(link).hover(showTip, hideTip);\r\n            }\r\n          }\r\n          // wrap link around image/video and add to document\r\n          link.appendChild(thumb);\r\n          div.insertBefore(link, div.lastChild);\r\n          $thumbsDiv.append(div);\r\n        });\r\n        $wrapDiv.append($thumbsDiv);\r\n        $sb.append($wrapDiv);\r\n        // init Masonry\r\n        $thumbsDiv.masonry({\r\n          itemSelector: `.${itemClass}`,\r\n        });\r\n        // listen for images loaded event\r\n        $thumbsDiv.imagesLoaded()\r\n          .progress(() => {\r\n            $thumbsDiv.masonry('layout');\r\n          })\r\n          .done(() => {\r\n            console.log('all images successfully loaded');\r\n            // show search bar\r\n            $sb.addClass('astock-searchbar-fadein');\r\n            // make sure it is visible in case class is missing\r\n            window.setTimeout(() => {\r\n              $sb.css({\r\n                visibility: 'visible',\r\n                opacity: 1,\r\n              });\r\n              // call Masonry layout one final time for Firefox!\r\n              $thumbsDiv.masonry('layout');\r\n            }, 1000);\r\n          });\r\n      } else {\r\n        console.warn('No images to render.');\r\n      }\r\n    }\r\n\r\n    // runs search using sdk and returns results\r\n    async function doSearch(params) {\r\n      // default filters\r\n      const defaultParams = {\r\n        offset: 0,\r\n        limit: 16,\r\n      };\r\n      // merge default filters with params from config\r\n      const searchParams = Object.assign(defaultParams, params);\r\n      console.log('Search query: %o', searchParams);\r\n      const queryParams = {\r\n        // if locale is set in config, use that instead of default\r\n        locale: ((stc.locale) ? stc.locale : 'en-US'),\r\n        search_parameters: searchParams,\r\n      };\r\n      // result fields to get back\r\n      // if result_columns exists in config, use that instead\r\n      let resultColumns = [];\r\n      const hasCustomColumns = Boolean(stc.custom && stc.custom.result_columns);\r\n      if (!hasCustomColumns) {\r\n        const imageColumns = [\r\n          AdobeStock.RESULT_COLUMNS.THUMBNAIL_HTML_TAG,\r\n          AdobeStock.RESULT_COLUMNS.DETAILS_URL,\r\n          AdobeStock.RESULT_COLUMNS.NB_RESULTS,\r\n        ];\r\n        const videoColumns = [\r\n          AdobeStock.RESULT_COLUMNS.TITLE,\r\n          AdobeStock.RESULT_COLUMNS.THUMBNAIL_URL,\r\n          AdobeStock.RESULT_COLUMNS.MEDIA_TYPE_ID,\r\n          AdobeStock.RESULT_COLUMNS.VIDEO_SMALL_PREVIEW_URL,\r\n          AdobeStock.RESULT_COLUMNS.VIDEO_SMALL_PREVIEW_CONTENT_TYPE,\r\n        ];\r\n        // if video support is enabled, include extra result columns\r\n        resultColumns = (stc.videoSupport) ? imageColumns.concat(videoColumns) : imageColumns;\r\n      } else {\r\n        const tempFields = stc.custom.result_columns;\r\n        // fully qualify result column names\r\n        const stkResults = AdobeStock.RESULT_COLUMNS;\r\n        tempFields.forEach((field) => {\r\n          resultColumns.push(stkResults[field]);\r\n        });\r\n        resultColumns.push(AdobeStock.RESULT_COLUMNS.NB_RESULTS);\r\n        console.log(resultColumns);\r\n      }\r\n      // create sdk instance\r\n      const stock = new AdobeStock(stc.apiKey, stc.appName, AdobeStock.ENVIRONMENT.PROD);\r\n      // execute search and load results\r\n      const iterator = stock.searchFiles(null, queryParams, resultColumns);\r\n      // iterate over returned Promise\r\n      return iterator.next().then(() => {\r\n        let files;\r\n        const response = iterator.getResponse();\r\n        if (response.nb_results > 0) {\r\n          ({ files } = response);\r\n        } else {\r\n          console.log('no results from Stock');\r\n        }\r\n        return files;\r\n      }).catch((err) => {\r\n        console.log(err);\r\n        return false;\r\n      });\r\n    }\r\n    // expose methods and objects outside Main object\r\n    return {\r\n      init: async () => {\r\n        // get reference to loaded jQuery\r\n        const { $jq } = window.StockThumbs;\r\n        // extract search options and run search\r\n        const result = await doSearch(parseFilters(stc.filters));\r\n        // runs callback after search results are returned (optional)\r\n        if (stc.callback && (typeof stc.callback === 'function')) {\r\n          stc.callback.apply(this, result);\r\n        }\r\n        // if custom code is present, return search results and run code instead of default behavior\r\n        if (stc.custom && stc.custom.exec) {\r\n          // call custom code main entry point\r\n          stc.custom.exec.call(this, result);\r\n        } else {\r\n          try {\r\n            // create search results\r\n            const $stockThumbs = $getContDiv(stc.parentId);\r\n            // create stock header\r\n            const $header = $jq(sbHeader);\r\n            $stockThumbs.append($header);\r\n            updateUiThumbs.apply(this, result);\r\n          } catch (error) {\r\n            console.warn('Unable to initialize StockThumbs.');\r\n          }\r\n        }\r\n      },\r\n      // expose search filters for troubleshooting\r\n      getFilters: () => { console.log(stc.filters); },\r\n      setFilters: (filters) => { console.log(filters); },\r\n      // export utils for external functions\r\n      utils,\r\n    };\r\n  };\r\n  // Get current path of script by triggering a stack trace\r\n  /*! @source https://gist.github.com/eligrey/5426730 */\r\n  window.StockThumbs.PATH = (() => {\r\n    const filename = 'fileName';\r\n    const stack = 'stack';\r\n    const stacktrace = 'stacktrace';\r\n    const sourceUrl = 'sourceURL';\r\n    const current = 'currentScript';\r\n    let loc = null;\r\n    const matcher = (name, matchedLoc) => {\r\n      loc = matchedLoc;\r\n    };\r\n\r\n    // for modern browsers\r\n    if (document[current] && document[current].src !== '') {\r\n      loc = document[current].src;\r\n      return loc.slice(0, loc.lastIndexOf('/') + 1);\r\n    }\r\n\r\n    try {\r\n      0(); // throws error\r\n      return false;\r\n    } catch (ex) {\r\n      if (filename in ex) { // Firefox\r\n        loc = ex[filename];\r\n      } else if (sourceUrl in ex) { // New Safari\r\n        loc = ex[sourceUrl];\r\n      } else if (stacktrace in ex) { // Opera\r\n        ex[stacktrace].replace(/called from line \\d+, column \\d+ in (.*):/gm, matcher);\r\n      } else if (stack in ex) { // WebKit, Blink, and IE10\r\n        ex[stack].replace(/at.*?\\(?(\\S+):\\d+:\\d+\\)?$/g, matcher);\r\n      }\r\n      return loc.slice(0, loc.lastIndexOf('/') + 1);\r\n    }\r\n  })();\r\n\r\n  // custom event dispatcher\r\n  const notify = (eventName) => {\r\n    const event = new Event(eventName);\r\n    // Dispatch the event.\r\n    console.log(`Dispatching event ${eventName}`);\r\n    window.dispatchEvent(event);\r\n  };\r\n\r\n  // notifies main script when everything is loaded\r\n  jqLoaded = (stc) => {\r\n    // get current path of script\r\n    const includePath = window.StockThumbs.PATH;\r\n    const SS = window.StockThumbs;\r\n    SS.$jq = jQuery.noConflict();\r\n    const { $jq } = SS;\r\n    const reqs = {\r\n      keywordx: 'keywordx.min.js',\r\n      imagesloaded: 'imagesloaded.pkgd.min.js',\r\n      adobestocklib: 'adobestocklib.min.js',\r\n      masonry: 'masonry.pkgd.min.js',\r\n    };\r\n      // remove/add custom libraries\r\n    if (stc.custom && (stc.custom.include || stc.custom.exclude)) {\r\n      const { exclude } = stc.custom;\r\n      const { include } = stc.custom;\r\n      if (exclude) {\r\n        exclude.forEach((name) => {\r\n            // eslint-disable-next-line no-prototype-builtins\r\n          if (reqs.hasOwnProperty(name)) {\r\n            delete reqs[name];\r\n          }\r\n        });\r\n      }\r\n      if (include) {\r\n        include.forEach((name) => {\r\n          reqs[name] = `${name}.js`;\r\n        });\r\n      }\r\n      console.log('new includes', reqs);\r\n    }\r\n    // loads other libraries using a promise\r\n    // https://www.geeksforgeeks.org/loading-multiple-scripts-dynamically-in-sequence-using-javascript/\r\n    const multiLoad = (info) => new Promise(((resolve, reject) => {\r\n      const scriptTag = document.createElement('script');\r\n      scriptTag.src = info;\r\n      scriptTag.async = false;\r\n      scriptTag.onload = () => resolve(info);\r\n      scriptTag.onerror = () => reject(info);\r\n      document.body.appendChild(scriptTag);\r\n    }));\r\n    const scriptArr = Object.values(reqs).map((script) => `${includePath}${script}`);\r\n    const promiseData = [];\r\n    scriptArr.forEach((info) => {\r\n      promiseData.push(multiLoad(info));\r\n    });\r\n    Promise.all(promiseData).then(() => {\r\n      console.log(`jQuery ${$jq().jquery} and all libraries loaded.`);\r\n        // dispatch event that searchbar is ready to load\r\n      SS.keywordx = window.keywordx;\r\n      SS.Masonry = window.Masonry;\r\n      notify('StockThumbsReady');\r\n    }).catch((err) => {\r\n      console.log(`${err} failed to load!`);\r\n    });\r\n  };\r\n\r\n  const domReadyHandler = (a) => {\r\n    const b = document;\r\n    const c = 'addEventListener';\r\n    if (b[c]) b[c]('DOMContentLoaded', a);\r\n    else window.attachEvent('onload', a);\r\n  };\r\n\r\n  domReadyHandler(() => {\r\n    // compares jQuery versions\r\n    // taken from https://stackoverflow.com/a/16187766\r\n    const cmpVersions = (a, b) => {\r\n      let i;\r\n      let diff;\r\n      const regExStrip0 = /(\\.0+)+$/;\r\n      const segmentsA = a.replace(regExStrip0, '').split('.');\r\n      const segmentsB = b.replace(regExStrip0, '').split('.');\r\n      const l = Math.min(segmentsA.length, segmentsB.length);\r\n      for (i = 0; i < l; i += 1) {\r\n        diff = parseInt(segmentsA[i], 10) - parseInt(segmentsB[i], 10);\r\n        if (diff) {\r\n          return diff;\r\n        }\r\n      }\r\n      return segmentsA.length - segmentsB.length;\r\n    };\r\n\r\n    let isJQCalled = false;\r\n    const checkJQ = () => {\r\n      // check for jQuery and load conditionally if version 1.9 or higher\r\n      let timerId;\r\n      if ((typeof window.jQuery === 'undefined' && !window.jQuery) || (cmpVersions('1.9', window.jQuery().jquery) >= 0)) {\r\n        if (!isJQCalled) {\r\n          const jQ = document.createElement('script');\r\n          jQ.type = 'text/javascript';\r\n          jQ.onload = jQ.onreadystatechange;\r\n          // jQ.onload = jqLoaded;\r\n          jQ.src = `${window.StockThumbs.PATH}/jquery.min.js`;\r\n          document.body.appendChild(jQ);\r\n          isJQCalled = true;\r\n        }\r\n        timerId = setTimeout(() => {\r\n          checkJQ();\r\n        }, 50);\r\n      } else {\r\n        if (timerId) { clearTimeout(timerId); }\r\n        notify('jQueryLoaded');\r\n      }\r\n    };\r\n    checkJQ();\r\n  });\r\n})();\r\n"],"mappings":"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"}